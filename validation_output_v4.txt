===========================================================
   JAX MD vs OpenMM Validation: 1UAO + ff19SB + OBC2
===========================================================

[1] Setting up OpenMM System...
OpenMM Total Energy (Vacuum): -248.2369 kcal/mol

[2] Setting up JAX MD System...
DEBUG: Using template for NGLY. Bonds: 8
DEBUG: Using template for TYR. Bonds: 21
DEBUG: Using template for ASP. Bonds: 11
DEBUG: Using template for PRO. Bonds: 14
DEBUG: Using template for GLU. Bonds: 14
DEBUG: Using template for THR. Bonds: 13
DEBUG: Using template for GLY. Bonds: 6
DEBUG: Using template for THR. Bonds: 13
DEBUG: Using template for TRP. Bonds: 25
DEBUG: Using template for CGLY. Bonds: 7

[DEBUG] First Residue (GLY) Atoms:
['N', 'CA', 'C', 'O', 'H1', 'H2', 'H3', 'HA2', 'HA3']
DEBUG: Using template for NGLY. Bonds: 8
DEBUG: Using template for TYR. Bonds: 21
DEBUG: Using template for ASP. Bonds: 11
DEBUG: Using template for PRO. Bonds: 14
DEBUG: Using template for GLU. Bonds: 14
DEBUG: Using template for THR. Bonds: 13
DEBUG: Using template for GLY. Bonds: 6
DEBUG: Using template for THR. Bonds: 13
DEBUG: Using template for TRP. Bonds: 25
DEBUG: Using template for CGLY. Bonds: 7

[DEBUG] Top 10 Closest Pairs:
  1. 0.9600 A: 97 (OG1) - 102 (HG1)
  2. 0.9600 A: 102 (HG1) - 97 (OG1)
  3. 0.9600 A: 76 (OG1) - 81 (HG1)
  4. 0.9600 A: 81 (HG1) - 76 (OG1)
  5. 0.9601 A: 20 (OH) - 29 (HH)
  6. 0.9601 A: 29 (HH) - 20 (OH)
  7. 0.9762 A: 106 (N) - 120 (H)
  8. 0.9762 A: 120 (H) - 106 (N)
  9. 0.9788 A: 114 (NE1) - 125 (HE1)
  10. 0.9788 A: 125 (HE1) - 114 (NE1)
Traceback (most recent call last):
  File "/Users/mar/MIT Dropbox/Marielle Russo/2025_workspace/PrxteinMPNN/scripts/debug_md/validate_1uao_ff19sb.py", line 796, in <module>
    run_validation()
    ~~~~~~~~~~~~~~^^
  File "/Users/mar/MIT Dropbox/Marielle Russo/2025_workspace/PrxteinMPNN/scripts/debug_md/validate_1uao_ff19sb.py", line 189, in run_validation
    jax_energy_total = energy_fn(jax_positions)
TypeError: 'NoneType' object is not callable
