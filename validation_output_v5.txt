/Users/mar/MIT Dropbox/Marielle Russo/2025_workspace/PrxteinMPNN/.venv/lib/python3.13/site-packages/jax/_src/numpy/reductions.py:232: UserWarning: Explicitly requested dtype <class 'jax.numpy.float64'> requested in sum is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return _reduction(a, "sum", lax.add, 0, preproc=_cast_to_numeric,
/Users/mar/MIT Dropbox/Marielle Russo/2025_workspace/PrxteinMPNN/.venv/lib/python3.13/site-packages/jax/_src/numpy/reductions.py:165: UserWarning: Explicitly requested dtype <class 'jax.numpy.float64'> requested in convert_element_type is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return lax.convert_element_type(result, dtype or result_dtype)
===========================================================
   JAX MD vs OpenMM Validation: 1UAO + ff19SB + OBC2
===========================================================

[1] Setting up OpenMM System...
OpenMM Total Energy (Vacuum): -248.2369 kcal/mol

[2] Setting up JAX MD System...
DEBUG: Using template for NGLY. Bonds: 8
DEBUG: Using template for TYR. Bonds: 21
DEBUG: Using template for ASP. Bonds: 11
DEBUG: Using template for PRO. Bonds: 14
DEBUG: Using template for GLU. Bonds: 14
DEBUG: Using template for THR. Bonds: 13
DEBUG: Using template for GLY. Bonds: 6
DEBUG: Using template for THR. Bonds: 13
DEBUG: Using template for TRP. Bonds: 25
DEBUG: Using template for CGLY. Bonds: 7

[DEBUG] First Residue (GLY) Atoms:
['N', 'CA', 'C', 'O', 'H1', 'H2', 'H3', 'HA2', 'HA3']
DEBUG: Using template for NGLY. Bonds: 8
DEBUG: Using template for TYR. Bonds: 21
DEBUG: Using template for ASP. Bonds: 11
DEBUG: Using template for PRO. Bonds: 14
DEBUG: Using template for GLU. Bonds: 14
DEBUG: Using template for THR. Bonds: 13
DEBUG: Using template for GLY. Bonds: 6
DEBUG: Using template for THR. Bonds: 13
DEBUG: Using template for TRP. Bonds: 25
DEBUG: Using template for CGLY. Bonds: 7

[DEBUG] Top 10 Closest Pairs:
  1. 0.9600 A: 97 (OG1) - 102 (HG1)
  2. 0.9600 A: 102 (HG1) - 97 (OG1)
  3. 0.9600 A: 76 (OG1) - 81 (HG1)
  4. 0.9600 A: 81 (HG1) - 76 (OG1)
  5. 0.9601 A: 20 (OH) - 29 (HH)
  6. 0.9601 A: 29 (HH) - 20 (OH)
  7. 0.9762 A: 106 (N) - 120 (H)
  8. 0.9762 A: 120 (H) - 106 (N)
  9. 0.9788 A: 114 (NE1) - 125 (HE1)
  10. 0.9788 A: 125 (HE1) - 114 (NE1)
DEBUG: Using provided gb_radii. Stats: Min=1.2000000476837158, Max=1.7000000476837158
DEBUG: Born Radii Min=1.498536229133606, Max=10.602158546447754, Mean=3.282336473464966
Traceback (most recent call last):
  File "/Users/mar/MIT Dropbox/Marielle Russo/2025_workspace/PrxteinMPNN/scripts/debug_md/validate_1uao_ff19sb.py", line 796, in <module>
    run_validation()
    ~~~~~~~~~~~~~~^^
  File "/Users/mar/MIT Dropbox/Marielle Russo/2025_workspace/PrxteinMPNN/scripts/debug_md/validate_1uao_ff19sb.py", line 189, in run_validation
    jax_energy_total = energy_fn(jax_positions)
  File "/Users/mar/MIT Dropbox/Marielle Russo/2025_workspace/PrxteinMPNN/src/prxteinmpnn/physics/system.py", line 358, in total_energy
    e_np = compute_nonpolar(r, born_radii, neighbor_idx)
  File "/Users/mar/MIT Dropbox/Marielle Russo/2025_workspace/PrxteinMPNN/src/prxteinmpnn/physics/system.py", line 318, in compute_nonpolar
    radii, born_radii, surface_tension=surface_tension, probe_radius=constants.PROBE_RADIUS
                                                                     ^^^^^^^^^
NameError: name 'constants' is not defined
